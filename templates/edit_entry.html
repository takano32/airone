{% extends 'base.html' %}

{% block title %}Edit Entry{% endblock %}

{% block nav_sub_header %}
<div class="conatiner-fluid">
  <ul class="breadcrumb airone-breadcrumb">
    <li class="breadcrumb-item"><a href="/">TOP</a></li>
    <li class="breadcrumb-item"><a href='/entry/{{ entry.schema.id }}'>{{ entry.schema.name }}</a></li>
    <li class="breadcrumb-item">{{ entry.name }}</li>
  </ul>
</div>
{% endblock %}

{% block content %}
  <h2>Edit ({{ entry.name }})</h2>
  <form url='/entry/do_edit/' method='post'>
    {% csrf_token %}
    <table>
      <tr>
        <th>属性名</th>
        <th>属性値</th>
      </tr>
      {% for attr in attributes %}
      <tr>
        <td>{{ attr.name }}</td>
        <td><input type='string' name='attr_value' attr_id='{{ attr.id }}' value='{{ attr.last_value }}'/></td>
      </tr>
      {% endfor %}
    </table>
    <input type='submit' value='Create' />
  </form>
<script src="/static/js/jquery-3.2.1.min.js"></script>
<script src="/static/js/http_request.js"></script>
  <script>
  $('form').submit(function(){
    attrs = []
    $(this).find('input[name=attr_value]').each(function(){
      attrs.push({
        'id': $(this).attr('attr_id'),
        'value': $(this).val(),
      });
    });
    HttpPost($(this), {'attrs': attrs});
  
    return false;
  });
  </script>
{% endblock %}
