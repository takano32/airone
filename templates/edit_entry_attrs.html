{% for attr in attributes %}
{% load bitwise_tags %}
<tr>
  <td>
    {% if attr.is_mandatory %}<strong>(*)</strong>{% endif %}{{ attr.name }}
  </td>
  <td>
    {% if attr.type|bitwise_and:attr_type_value.array %}
      <div id='container-{{ attr.id }}'>
        <button type="button" class="btn btn-primary btn-sm" name='add_attr'>add row</button>

        <!-- template of attribute value column -->
        <div style="display:none" class='attr_value_template' id='template-{{ attr.id }}'>
          <div class='col-4'>
            {% if attr.type == attr_type.array_entry %}
              <select class='attr_value' attr_id='{{ attr.id }}'>
                {% if not attr.is_mandatory %}
                <option value='0'>- NOT SET -</option>
                {% endif %}

                {% for referral in attr.referrals %}
                <option value='{{ referral.id }}'>{{ referral.name }}</option>
                {% endfor %}
              </select>
            {% else %}
              <input type='text' class='attr_value' attr_id='{{ attr.id }}'/>
            {% endif %}
          </div>
          <div class='col'>
            <button type="button" class="btn btn-danger btn-sm" name="del_attr">del</button>
          </div>
        </div>
      </div>
    {% else %}
      {% if attr.type == attr_type.entry %}
      <select class="attr_value" attr_id="{{ attr.id }}">
        {% if not attr.is_mandatory %}
        <option value='0'>- NOT SET -</option>
        {% endif %}

        {% for referral in attr.referrals %}
        <option value="{{ referral.id }}"{% if referral.id == attr.last_referral.id %} selected="selected" {% endif %}>{{ referral.name }}</option>
        {% endfor %}
      </select>
      {% elif attr.type == attr_type.textarea %}
      <textarea class="attr_value" attr_id="{{ attr.id }}" cols="80" rows="10">{{ attr.last_value }}</textarea>
      {% else %}
      <input type="text" class="attr_value" attr_id="{{ attr.id }}" value="{{ attr.last_value }}"/>
      {% endif %}
    {% endif %}
  </td>
  <td>
    <a href="/acl/{{ attr.id }}"><button type="button" class="btn btn-info btn-sm">ACL</button></a>
  </td>
</tr>
{% endfor %}
